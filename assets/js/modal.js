jQuery(document).ready(function($){var builder_wrapper=$('#bon-builder-wrapper');var builder_modal={template:'<div id="bon-builder-meta-modal"><div id="bon-builder-meta-modal-overlay"></div><div id="bon-builder-meta-modal-wrapper"><div id="bon-builder-meta-modal-inner-wrapper"><div class="bon-builder-meta-modal-header"><div id="icon-options-general" class="icon32"></div><h3></h3><div id="bon-builder-meta-modal-close">âœ•</div></div><div id="bon-builder-meta-modal-content"></div><div class="bon-builder-meta-modal-footer"><input type="button" value="Save" id="bon-builder-meta-modal-save" class="button button-primary"/><br class="clear"></div></div></div></div>'};$('body').append(builder_modal.template);var builder_modal_box=$('body').find('#bon-builder-meta-modal-wrapper');var builder_overlay=$('body').find('#bon-builder-meta-modal-overlay');var builder_content=builder_modal_box.find('#bon-builder-meta-modal-content');var builder_header=$('.bon-builder-meta-modal-header h3');var builder_clicked_item='';var builder_edit_item='';var builder_clone_item='';builder_modal_box.children().css('display','none');$('#bon-builder-meta-modal-close').click(function(){btCloseModal()});$('#bon-builder-selected-elements').on('click','.action-edit-element',function(){builder_clicked_item=$(this);btOpenModal()});$('#bon-builder-meta-modal-save').click(function(){btCloseModal()});function btOpenModal(){builder_edit_item=builder_clicked_item.parents('.bon-builder-single-elem-wrap').siblings('#bon-builder-element-meta');builder_item_title=builder_clicked_item.parents('.bon-builder-single-elem-wrap').data('title');builder_clone_item=builder_edit_item.children().clone(true);builder_header.html(builder_item_title);$('body').css({'height':windowHeight,'overflow':'hidden'});var windowWidth=$(window).outerWidth();var windowHeight=$(window).outerHeight();builder_modal_box.css({'width':windowWidth*65/100,'height':windowHeight*88/100,'position':'fixed','z-index':'1003','top':(windowHeight-(windowHeight*88/100))/2,'left':(windowWidth-(windowWidth*65/100))/2});builder_overlay.css({'opacity':0.7,'height':windowHeight,'width':windowWidth,'position':'fixed','left':'0px','top':'0px','z-index':'1001'});builder_content.css({'height':(builder_modal_box.outerHeight()-$('.bon-builder-meta-modal-header').outerHeight(true)-$('.bon-builder-meta-modal-footer').outerHeight(true)-100)});builder_content.append(builder_clone_item);builder_modal_box.children().show()}function btCloseModal(){var builder_edited_item=builder_content.children().clone(true);if(builder_edit_item){builder_edit_item.html(builder_edited_item)}btResetModal()}function btResetModal(){$('body').removeAttr('style');builder_modal_box.removeAttr('style').children().hide();builder_overlay.removeAttr('style');builder_content.children().remove();builder_header.html('');builder_edit_item='';builder_clone_item='';builder_clicked_item=''}$('body').on('click','#bon-builder-add-child',function(){var added_tab=$(this).parents("#bon-builder-added-tab");var clone_tab=added_tab.find("li:last").clone(true);clone_tab.find('input, select').attr('value',function(){return''});clone_tab.find('textarea').text(function(){return''});added_tab.siblings("#repeat-count").val(function(){return parseInt($(this).val())+1});added_tab.children("ul").append(clone_tab)});$('body').on('click','.bon-builder-remove-child',function(){var deleted_tab=$(this);var repeat_count=deleted_tab.parents('#bon-builder-added-tab').siblings("#repeat-count").val();if(repeat_count>1){var answer=confirm('Are you sure to delete this?');if(answer){deleted_tab.parents('#bon-builder-added-tab').siblings().val(function(){return parseInt($(this).val())-1});deleted_tab.parent().parent().remove()}}});var imageFrame;$('body').on('click','.bon-builder-upload-button',function(event){var options,attachment;$self=$(this);event.preventDefault();if(imageFrame){imageFrame.open();return}imageFrame=wp.media({title:'Choose Image',multiple:false,library:{type:'image'},button:{text:'Use This Image'}});imageFrame.on('select',function(){selection=imageFrame.state().get('selection');if(!selection)return;selection.each(function(attachment){var src=attachment.attributes.sizes.full.url;$self.prev('.upload_media_text_meta').val(src)})});imageFrame.open()})});(function(original){jQuery.fn.clone=function(){var result=original.apply(this,arguments),default_textareas=this.find('textarea, select'),result_textareas=result.find('textarea, select');for(var i=0,l=default_textareas.length;i<l;++i){jQuery(result_textareas[i]).val(jQuery(default_textareas[i]).val())}return result}})(jQuery.fn.clone);